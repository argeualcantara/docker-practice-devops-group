name: 'Docker Build and Push'
description: 'Build and pushes a docker image to dockerhub'
inputs:
  version: 
    description: "version"
    required: true
  repo:
    description: "repo name"
    required: true
  dockerHubLogin:
    description: "docker hub login"
    required: true
  dockerHubPassword:
    description: "docker hub password"
    required: true
  push:
    description: "boolean push or not the image"
    required: true
    default: false
  context:
    description: "docker context"
    required: true
    default: "."
runs:
  using: "composite"
  steps:
    - name: Login to Docker Hub
      shell: bash
      id: docker-login
      run: |
        docker login -u "${{ inputs.dockerHubLogin }}" -p "${{ inputs.dockerHubPassword }}"
    - name: Build, tag, and push image to Docker Hub
      shell: bash
      id: build-image
      run: |
        docker build -t ${{ inputs.dockerHubLogin }}/${{ inputs.repo }}:${{ inputs.version }} ${{ inputs.context }}
        if [ "${{ inputs.push }}" == "true" ]; then
          docker push  ${{ inputs.dockerHubLogin }}/${{ inputs.repo }}:${{ inputs.version }}
        fi
